document.addEventListener("DOMContentLoaded", () => { const body = document.body; const btnTheme = document.getElementById("btn-theme"); const btnHome = document.getElementById("btn-home"); const btnFontInc = document.getElementById("btn-font-inc"); const btnFontDec = document.getElementById("btn-font-dec"); const btnNarrator = document.getElementById("btn-narrator"); const btnLanguage = document.getElementById("btn-language"); const searchInput = document.getElementById("search-input"); const storedTheme = localStorage.getItem("gsp-pei-theme"); if (storedTheme === "light") { body.classList.remove("dark-theme"); body.classList.add("light-theme"); } btnTheme?.addEventListener("click", () => { body.classList.toggle("light-theme"); const isLight = body.classList.contains("light-theme"); localStorage.setItem("gsp-pei-theme", isLight ? "light" : "dark"); }); btnHome?.addEventListener("click", () => { const path = window.location.pathname || ""; const isIndex = path.endsWith("index.html") || path.endsWith("/"); if (isIndex) { window.scrollTo({ top: 0, behavior: "smooth" }); } else { window.location.href = "index.html"; } }); let baseFontSize = 16; const applyFontSize = () => { document.documentElement.style.fontSize = baseFontSize + "px"; }; btnFontInc?.addEventListener("click", () => { if (baseFontSize < 20) { baseFontSize += 1; applyFontSize(); } }); btnFontDec?.addEventListener("click", () => { if (baseFontSize > 14) { baseFontSize -= 1; applyFontSize(); } }); let speaking = false; btnNarrator?.addEventListener("click", () => { if (!("speechSynthesis" in window)) { alert("El narrador no estÃ¡ disponible en este navegador."); return; } const synth = window.speechSynthesis; if (speaking) { synth.cancel(); speaking = false; return; } const main = document.getElementById("main-content"); if (!main) return; const text = main.innerText; if (!text.trim()) return; const utter = new SpeechSynthesisUtterance(text); if (document.documentElement.lang === "en") { utter.lang = "en-US"; } else if (document.documentElement.lang === "fr") { utter.lang = "fr-FR"; } else { utter.lang = "es-ES"; } utter.onend = () => { speaking = false; }; speaking = true; synth.speak(utter); }); let currentLang = "es"; const translatable = document.querySelectorAll("[data-i18n-es]"); const translatablePlaceholders = document.querySelectorAll("[data-i18n-placeholder-es]"); const translatableTitles = document.querySelectorAll("[data-i18n-title-es]"); const translatableAriaLabels = document.querySelectorAll("[data-i18n-aria-label-es]"); const getI18nValue = (el, baseAttr) => { let text = ""; if (currentLang === "en") { text = el.getAttribute(baseAttr + "-en") || el.getAttribute(baseAttr + "-es") || ""; } else if (currentLang === "fr") { text = el.getAttribute(baseAttr + "-fr") || el.getAttribute(baseAttr + "-en") || el.getAttribute(baseAttr + "-es") || ""; } else { text = el.getAttribute(baseAttr + "-es") || ""; } return text; }; const updateLanguage = () => { if (currentLang === "en") { document.documentElement.lang = "en"; } else if (currentLang === "fr") { document.documentElement.lang = "fr"; } else { document.documentElement.lang = "es"; } translatable.forEach(el => { const text = getI18nValue(el, "data-i18n"); if (text) { el.innerHTML = text; } }); translatablePlaceholders.forEach(el => { const text = getI18nValue(el, "data-i18n-placeholder"); if (text) { el.setAttribute("placeholder", text); } }); translatableTitles.forEach(el => { const text = getI18nValue(el, "data-i18n-title"); if (text) { el.setAttribute("title", text); } }); translatableAriaLabels.forEach(el => { const text = getI18nValue(el, "data-i18n-aria-label"); if (text) { el.setAttribute("aria-label", text); } }); if (btnLanguage) { if (currentLang === "es") { btnLanguage.title = "Cambiar idioma ES/EN/FR"; } else if (currentLang === "en") { btnLanguage.title = "Switch language ES/EN/FR"; } else { btnLanguage.title = "Changer la langue ES/EN/FR"; } } }; if (btnLanguage) { btnLanguage.addEventListener("click", () => { if (currentLang === "es") { currentLang = "en"; } else if (currentLang === "en") { currentLang = "fr"; } else { currentLang = "es"; } updateLanguage(); }); } const docLang = document.documentElement.lang; if (docLang === "en") { currentLang = "en"; } else if (docLang === "fr") { currentLang = "fr"; } else { currentLang = "es"; } updateLanguage(); const cards = Array.from(document.querySelectorAll("[data-search-tags], .card")); const cardsForAnimation = Array.from(document.querySelectorAll(".card")); if (window.anime && typeof window.anime.animate === "function" && cardsForAnimation.length) { const { animate } = window.anime; animate(cardsForAnimation, { opacity: { from: 0, to: 1 }, y: { from: 18, to: 0 }, duration: 700, delay: (_, i) => 80 * i, easing: "outCubic" }); cardsForAnimation.forEach(card => { let hoverAnimation; card.addEventListener("mouseenter", () => { if (hoverAnimation) hoverAnimation.pause?.(); hoverAnimation = animate(card, { scale: { to: 1.03 }, duration: 260, easing: "outCubic" }); }); card.addEventListener("mouseleave", () => { if (hoverAnimation) hoverAnimation.pause?.(); hoverAnimation = animate(card, { scale: { to: 1 }, duration: 260, easing: "outCubic" }); }); }); } searchInput?.addEventListener("input", () => { const query = searchInput.value.trim().toLowerCase(); cards.forEach(card => { const haystack = (card.getAttribute("data-search-tags") || "") + " " + card.textContent.toLowerCase(); if (!query || haystack.includes(query)) { card.style.display = ""; } else { card.style.display = "none"; } }); }); (function () { document.addEventListener("contextmenu", function (e) { e.preventDefault(); }); document.addEventListener("keydown", function (e) { const key = (e.key || "").toUpperCase(); if (key === "F12") { e.preventDefault(); e.stopPropagation(); return; } if (e.ctrlKey && e.shiftKey && ["I", "J", "C"].includes(key)) { e.preventDefault(); e.stopPropagation(); return; } if (e.ctrlKey && !e.shiftKey && ["U", "S", "P", "C"].includes(key)) { e.preventDefault(); e.stopPropagation(); return; } }); document.querySelectorAll("img").forEach(function (img) { img.setAttribute("draggable", "false"); img.addEventListener("dragstart", function (e) { e.preventDefault(); }); img.addEventListener("contextmenu", function (e) { e.preventDefault(); }); }); var style = document.createElement("style"); style.innerHTML = "@media print { body { visibility: hidden !important; } body.print-allowed, body.print-allowed * { visibility: visible !important; } }"; document.head.appendChild(style); })(); if ("serviceWorker" in navigator) { navigator.serviceWorker.register("sw.js").catch(() => {}); } });